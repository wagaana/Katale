"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6046],{6046:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var i=a(629),r=a(538),l=a(2640);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===n(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c={data:function(){return{overlay:!1,uploads:l.q6,fullscreenLoading:!1,campaignOffer:{},e6:1,emailTemplate:{parameters:[]},temp:{},dialogRead:!1,activeField:null,action:"",activeTableMappings:[{id:"userId",label:"User Id"},{id:"email",label:"Email Address"},{id:"phone",label:"Phone Number"},{id:"userName",label:"User Name"},{id:"emailVerified",label:"Email Varified"},{id:"level",label:"User level"},{id:"dob",label:"Date Of Birth"},{id:"gender",label:"User Gender"},{id:"joinDate",label:"Join Date"}]}},created:function(){"vewOffer"===this.$route.query.action&&(this.action=this.$route.query.action,this.$store.dispatch("loadSystemCampaignOfferDetails",this.$route.query.id)),this.$store.dispatch("loadCampaignTemplates")},computed:o(o({getEmailTemplateHtml:function(){var e=this;try{for(var t in console.log(e.campaignOffer.templateID),e.getCampaignTemplates)if(e.getCampaignTemplates[t].templateID===e.campaignOffer.templateID){e.emailTemplate=e.getCampaignTemplates[t];break}}catch(e){console.log("Error getting template")}var a=e.emailTemplate.html;for(var i in e.emailTemplate.parameters){var r=e.emailTemplate.parameters[i].value,l=e.emailTemplate.parameters[i].placeHolder;"file"===e.emailTemplate.parameters[i].inputType&&(l="".concat(e.uploads).concat(l)),a=a.replace(r,l)}return a},validateFieldsCampaignDetailsForm:function(){var e=!0;return void 0!==this.campaignOffer.label&&""!==this.campaignOffer.label||(e=!1),void 0!==this.campaignOffer.description&&""!==this.campaignOffer.description||(e=!1),e},validateOfferForm:function(){return!0}},(0,i.rn)(["systemCampaignOfferDetails","isUpdating","campaignTemplates","campaignsOffersOptions","uploadedCampaignOfferFile"])),(0,i.Se)(["getSystemCampaignOfferDetails","messageAlert","getUpdatingStatus","getCampaignTemplates","getUploadedCampaignOfferFile"])),watch:{messageAlert:function(e){null!=e&&r.default.notify({group:"foo",type:e.type,text:e.body})},getSystemCampaignOfferDetails:function(e){console.log("getSystemCampaignOfferDetails",e),this.emailTemplate.parameters=e.parameters,this.emailTemplate.html=e.html,this.campaignOffer=e},getUploadedCampaignOfferFile:function(e){var t=this;e&&setTimeout((function(){var a=t.emailTemplate.parameters.findIndex((function(t){return t.id==parseInt(e.reference)}));t.emailTemplate.parameters[a].placeHolder=e.fileName,t.overlay=!1}),3e3)}},methods:{displayFormError:function(e){r.default.notify({group:"foo",title:"Error",text:e,type:"error"})},onImageFileChange:function(e,t){if(console.log(e),null!==e){this.overlay=!0;var a=new FormData;a.append("image",e),a.append("reference",t.id),this.$store.dispatch("uploadCampaignOfferFile",a)}},showModal:function(e){this.dialogRead=!0},appendSelectedParam:function(e){var t=this;if(null==this.activeField)this.campaignOffer.template.message=this.campaignOffer.template.message+" {"+e.id+"}";else{var a=this.emailTemplate.parameters.findIndex((function(e){return e.value==t.activeField})),i=this.emailTemplate.parameters[a].placeHolder;i=null==i||null==i?" {"+e.id+"}":i+" {"+e.id+"}",this.emailTemplate.parameters[a].placeHolder=i,this.emailTemplate.parameters[a].placeHolder=i}this.dialogRead=!1},submitCampaignOffer:function(){this.campaignOffer.html=this.emailTemplate.html,this.campaignOffer.parameters=this.emailTemplate.parameters,console.log("submitCampaignOffer",this.campaignOffer),this.$store.dispatch("submitCampaignOffer",this.campaignOffer)},updateCampaignOffer:function(){this.campaignOffer.html=this.emailTemplate.html,this.campaignOffer.parameters=this.emailTemplate.parameters,console.log("updateCampaignOffer",this.campaignOffer),this.$store.dispatch("updateCampaignOffer",this.campaignOffer)}}};const m=(0,a(1900).Z)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",[t("v-stepper",{attrs:{vertical:""},model:{value:e.e6,callback:function(t){e.e6=t},expression:"e6"}},[t("v-stepper-step",{attrs:{complete:e.e6>1,step:"1"}},[e._v("\n        Campaign Offer Details\n        "),t("small",[e._v("Describe your campaign offer below.")])]),e._v(" "),t("v-stepper-content",{attrs:{step:"1"}},[t("v-card",{staticClass:"mb-12"},[t("v-container",[t("v-text-field",{attrs:{label:"Campaign Offer Name",outlined:"",dense:""},model:{value:e.campaignOffer.label,callback:function(t){e.$set(e.campaignOffer,"label",t)},expression:"campaignOffer.label"}}),e._v(" "),t("v-textarea",{attrs:{label:"Campaign Offer Description",outlined:"",dense:""},model:{value:e.campaignOffer.description,callback:function(t){e.$set(e.campaignOffer,"description",t)},expression:"campaignOffer.description"}})],1)],1),e._v(" "),t("v-btn",{staticClass:"md-1 px-6"},[e._v("Cancel")]),e._v(" "),t("v-btn",{attrs:{color:"primary"},on:{click:function(t){0!=e.validateFieldsCampaignDetailsForm?e.e6=2:e.displayFormError("Please fill all required Fields.")}}},[e._v("Continue")])],1),e._v(" "),t("v-stepper-step",{attrs:{complete:e.e6>2,step:"2"}},[e._v("Configure Campaign Offer.")]),e._v(" "),t("v-stepper-content",{attrs:{step:"2"}},[t("v-card",{staticClass:"mb-3"},[t("v-container",[t("div",{staticClass:"mb-3 row"},[t("div",{staticClass:"col-md-6 col"},[t("div",{staticClass:"col-md-12"},[t("v-text-field",{attrs:{placeholder:"Email Subject",outlined:"",dense:""},model:{value:e.campaignOffer.subject,callback:function(t){e.$set(e.campaignOffer,"subject",t)},expression:"campaignOffer.subject"}}),e._v(" "),t("div",e._l(e.emailTemplate.parameters,(function(a,i){return t("span",{key:i},["file"===a.inputType?t("v-file-input",{attrs:{label:a.label,outlined:"",dense:""},on:{change:function(t){return e.onImageFileChange(t,a)}}}):e._e(),e._v(" "),"string"===a.inputType?t("v-text-field",{attrs:{label:a.label,outlined:"",dense:""},model:{value:a.placeHolder,callback:function(t){e.$set(a,"placeHolder",t)},expression:"parameter.placeHolder"}}):e._e(),e._v(" "),"text"===a.inputType?t("div",{staticStyle:{position:"relative"}},[t("v-textarea",{attrs:{outlined:"",dense:"",label:a.label},model:{value:a.placeHolder,callback:function(t){e.$set(a,"placeHolder",t)},expression:"parameter.placeHolder"}}),e._v(" "),t("v-btn",{staticStyle:{position:"absolute",right:"5px",top:"5px",padding:"5px 10px","font-weight":"bold"},attrs:{variant:"outline-primary"},on:{click:function(t){e.activeField=a.value,e.showModal("modalUserParams")}}},[e._v("{}")])],1):e._e()],1)})),0)],1)]),e._v(" "),t("div",{staticClass:"col-md-6 col"},[t("div",{staticClass:"col-md-12"},[t("v-select",{attrs:{label:"Offer Template",items:e.getCampaignTemplates,"item-text":"label","item-value":"templateID",outlined:"",dense:""},model:{value:e.campaignOffer.templateID,callback:function(t){e.$set(e.campaignOffer,"templateID",t)},expression:"campaignOffer.templateID"}}),e._v(" "),t("v-card",{staticClass:"col-md-12",domProps:{innerHTML:e._s(e.getEmailTemplateHtml)}})],1)])])])],1),e._v(" "),t("v-btn",{staticClass:"md-1 px-6",on:{click:function(t){e.e6=1}}},[e._v("Back")]),e._v(" "),"vewOffer"!==e.action?t("v-btn",{attrs:{color:"primary"},on:{click:function(t){0!=e.validateOfferForm?e.submitCampaignOffer():e.displayFormError("Please provide the offer.")}}},[e._v("Submit")]):t("v-btn",{attrs:{color:"primary"},on:{click:function(t){0!=e.validateOfferForm?e.updateCampaignOffer():e.displayFormError("Please provide the offer.")}}},[e._v("Update")])],1)],1),e._v(" "),t("v-dialog",{attrs:{width:"400"},model:{value:e.dialogRead,callback:function(t){e.dialogRead=t},expression:"dialogRead"}},[t("v-card",[t("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[t("v-toolbar-title",[e._v("Select Field to Add")])],1),e._v(" "),t("v-card",{staticClass:"pa-5"},e._l(e.activeTableMappings,(function(a,i){return t("v-row",{key:"field: ".concat(i),staticClass:"mb-3"},[t("v-btn",{staticStyle:{width:"100%"},attrs:{variant:"outline-primary"},on:{click:function(t){return e.appendSelectedParam(a)}}},[e._v(e._s(a.label))])],1)})),1)],1)],1),e._v(" "),t("v-overlay",{attrs:{value:e.overlay}},[t("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)])}),[],!1,null,null,null).exports},1900:(e,t,a)=>{function i(e,t,a,i,r,l,n,s){var o,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=a,p._compiled=!0),i&&(p.functional=!0),l&&(p._scopeId="data-v-"+l),n?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},p._ssrRegister=o):r&&(o=s?function(){r.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:r),o)if(p.functional){p._injectStyles=o;var c=p.render;p.render=function(e,t){return o.call(t),c(e,t)}}else{var m=p.beforeCreate;p.beforeCreate=m?[].concat(m,o):[o]}return{exports:e,options:p}}a.d(t,{Z:()=>i})}}]);